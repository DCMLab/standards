
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Technical Specifications &#8212; Harmonic Annotation Guidelines 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Annotator’s Guidelines" href="guidelines.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="technical-specifications">
<h1>Technical Specifications<a class="headerlink" href="#technical-specifications" title="Permalink to this headline">¶</a></h1>
<p>These specs fulfill at least two purposes:</p>
<ul class="simple">
<li><p>Keeping track of what the DCML harmony labels express</p></li>
<li><p>Being a resource for researchers and developers who want to interact with them</p></li>
</ul>
<p>This way, the annotation standard’s current limitations become transparent
and everyone who wants to help improving them can be on the same page. The
current state of the corresponding discussions can be seen in this repo’s
<a class="reference external" href="https://github.com/DCMLab/standards/issues">issue tracker</a>.</p>
<div class="section" id="what-is-being-encoded">
<h2>What is being encoded?<a class="headerlink" href="#what-is-being-encoded" title="Permalink to this headline">¶</a></h2>
<p>This section elicits the general principles and assumptions underlying the
DCML harmony annotation standard.</p>
<div class="section" id="segmentations">
<h3>Segmentations<a class="headerlink" href="#segmentations" title="Permalink to this headline">¶</a></h3>
<p>DCML harmony labels represent a score segmentation on various levels:</p>
<ul class="simple">
<li><p>key areas (tonalities)</p></li>
<li><p>harmonic segments</p></li>
<li><p>chord and non-chord tones are distinguished from ornaments</p></li>
</ul>
<p>The annotations follow the basic principle that a key or a harmony begins at the
timestamp that the designating label is attached to and stays effective up to
the subsequent change (half-open intervals). Following this principle</p>
<ul class="simple">
<li><p>the <strong>key</strong> is defined for every harmony as long as the first harmony label
comes with information about its key;</p></li>
<li><p>from the first harmony label onwards, the beginning of every event falls
into exactly one <strong>harmonic segment</strong>.</p></li>
</ul>
<p>By <strong>key</strong> we understand an ordered set of unique tonal pitch classes (a
<strong>scale</strong>) of which
we call the first one <strong>root</strong> (<cite>tonic, home, one, I, 1, (relative) DO</cite>,
etc.). The annotation standard is an expression of the basic assumption that
the music to which it is being applied is hierarchically organised ‘around’
the root. This is expressed through numbering the key’s ordered pitch classes,
its scale degrees, using either Roman or Arabic numerals, depending on the
context. Tones which are not part of the key’s scale are expressed in relation
to its scale degrees via the accidentals {♯♮♭} which we facilitate to {#b}.</p>
<p>By <strong>harmonic segment</strong> we understand a continuous score segment encompassing
all staves. Therefore, it has the same morphology as a slice with the difference
that the word slice is generally associated with a harmonic segment which does
have a duration but no rhythm. In that sense, harmonic segment is the more
general concept which can include anything from a single slice to a whole piece.
The criterion for harmonic segmentation is a given set of features: The music
pertaining to harmonic segments that have been identically labelled has
the same harmonic features, provided that the identical set of features has
been used as segmentation criterion in all cases.</p>
<p>Additionally, the standard offers the possibility to annotate <strong>phrases</strong>. These
cannot be hierarchically nested but most naturally they should coincide with
one given level of a hierarchical form analysis. The annotator’s guidelines are
quite vague in this regard and leave it open on which hierarchical level – if
at all – the annotator wants to use phrase annotations.</p>
<p>The following section explains how the segmentations’ timestamps are
encoded whereas the expression of chord and non-chord tones will be
specified in the <a class="reference internal" href="#regex"><span class="std std-ref">regEx</span></a> section below.</p>
</div>
<div class="section" id="timestamps">
<h3>Timestamps<a class="headerlink" href="#timestamps" title="Permalink to this headline">¶</a></h3>
<p>The way DCML harmony labels are entered in the <a class="reference external" href="https://musescore.org/en/download">MuseScore 3</a>
notation software ensures that each of them is attached to a timestamp in the
score. The software allows for attaching several labels to the same time point,
even in the same staff but annotators are asked to avoid this and to use
<a class="reference internal" href="guidelines.html#ambiguity"><span class="std std-ref">encoded ambiguity</span></a> instead. In principle, it would be possible
have one score include several simultaneous annotation layers, the labels of
which would only need to have a clearly distinguishable syntax.</p>
<p>By <strong>timestamp</strong> we understand a uniquely identifiable position. In the case of
music scores there are several possible referencing systems out of which we are
using references to a measure (bar) and a position within this measure. The
<strong>position</strong>, which we call ‘onset’, is measured from the measure’s beginning
(starting from 0) and expressed as fractions representing quarter note durations
which can be easily transformed in any kind of beat representation. For example,
the position at one quarter note after beat 1 has <code class="docutils literal notranslate"><span class="pre">onset</span> <span class="pre">=</span> <span class="pre">1/4</span></code> regardless of
the time signature. When it comes to referencing measures, there are two
different ways of referencing measures, as is the  case for all XML encodings of
measured music (musicXML, MEI). These two different ways we call <strong>measure
number (MN)</strong> and <strong>measure count (MC)</strong>.</p>
<ul class="simple">
<li><p>MNs represent a running count of complete measures and correspond to the
numbers that can be found in printed scores. They follow several conventions
(such as anacruses being numbered as 0, first and second endings having the same
number, etc.) and are the typical way for humans to refer to measures.</p></li>
<li><p>MCs on the other hand are a running count of measure units in the XML score and
therefore they count any kind of complete and incomplete (i.e. split) measures
alike. Therefore, they are independent of conventions and identify a certain
measure unit unambiguously (whereas a MN might refer to several MCs). That is
why MCs are the ideal way for machines to refer to measures.</p></li>
</ul>
<p>Musescore displays both kinds of numbers: MCs are shown in the status bar when
clicking on a measure, whereas MNs are shown in the score (if activated) and in
the Navigator pane. It follows that our timestamps have to be able to mediate
between the two referencing schemes, i.e. the one for humans and the one for
machines. This requires some particular care with regard  to score consistency.
Concretely, this means that the above-mentioned conventions for MNs need to be
correctly encoded in the MuseScore files, enabling a correct mapping of MCs to
the MNs as they can (or could) be found in an original print. In particular, for
the following cases one has to ensure that an MC is “excluded from bar count”
(as it is called in MuseScore):</p>
<ul>
<li><p>anacruses;</p></li>
<li><p>every part of split measures except the first one; (split measures often
occur at section breaks in pieces maintaining an upbeat)</p></li>
<li><p>all measures pertaining to a second (or third etc.) ending. For endings
longer than one MN, MuseScore’s “Add to bar number” has to be used with a
negative value (<a class="reference internal" href="#volta-numbering"><span class="std std-ref">see below</span></a>).</p>
<blockquote>
<div><p>The “exclude from bar count” function is mainly needed to ensure correct
display of MNs in Musescore, but also for dubious or non-standard cases. The
logic of the mapping MC -&gt; MN can otherwise be implemented easily.</p>
</div></blockquote>
</li>
</ul>
<p>Consequently, when printing a list of labels, we use <em>three columns</em> for the
respective timestamps which should satisfy all needs. Note that we count MCs
starting with 1 in order to match MuseScore’s behaviour in the status bar. Also
note that there are two potential ways of expressing positions (onsets), namely
with respect to the respective MC or to the respective MN. In order to facilitate
correct conversion to beats, we generally print the latter as can be seen in the
examples below. However, for referencing a position in the score, the MN-onset
needs to be converted into the correct MC-onset. Implementation-wise this can
be accomplished by keeping track of each MC’s ‘offset’ from the corresponding
MN’s beginning, which in most cases will be 0.</p>
<div class="figure align-default" id="id1">
<img alt="Measure counts vs. measure numbers for an anacrusis" src="_images/mc-mn-anacrusis.png" />
<p class="caption"><span class="caption-text"><strong>Correct timestamps for the beginning of Bourrée I from Bach’s
`English Suite No. 1` BWV 806.</strong></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
<div class="legend">
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 32%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>mc</p></th>
<th class="head"><p>mn</p></th>
<th class="head"><p>onset</p></th>
<th class="head"><p>label</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>0</p></td>
<td><p>3/4</p></td>
<td><p>.A.V</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>I</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>1/2</p></td>
<td><p>I6</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>1</p></td>
<td><p>3/4</p></td>
<td><p>I</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note how in this example, the first labels’
position is given as <code class="docutils literal notranslate"><span class="pre">onset</span> <span class="pre">==</span> <span class="pre">3/4</span></code> because MN 0 was internally treated as
the second part of a split bar, resulting in the above-mentioned ‘offset’
value for MC 1 to be <code class="docutils literal notranslate"><span class="pre">3/4</span></code> which would translate correctly to beat
4 in 4/4 meter or beat 2.5 in 2/2.</p>
<div class="figure align-default" id="id2">
<img alt="Measure counts vs. measure numbers for first and second endings" src="_images/mc-mn-voltas.png" />
<p class="caption"><span class="caption-text"><strong>mm. 16ff. of the same piece as an example for correct timestamps in the case
of first and second endings.</strong></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
<div class="legend">
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>mc</p></th>
<th class="head"><p>mn</p></th>
<th class="head"><p>onset</p></th>
<th class="head"><p>label</p></th>
<th class="head"><p>volta</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>17</p></td>
<td><p>16</p></td>
<td><p>0</p></td>
<td><p>V</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>16</p></td>
<td><p>1/2</p></td>
<td><p>V6</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>16</p></td>
<td><p>3/4</p></td>
<td><p>V2</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>17</p></td>
<td><p>0</p></td>
<td><p>I6</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>17</p></td>
<td><p>1/2</p></td>
<td><p>I</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>16</p></td>
<td><p>0</p></td>
<td><p>V\</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>(20)</p></td>
<td><p>(16)</p></td>
<td><p>(3/4)</p></td>
<td><p>(V)</p></td>
<td><p>(2)</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>17</p></td>
<td><p>0</p></td>
<td><p>I</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note how MCs identify every measure unit of the score unambiguously whereas the
official conventions intend MNs 16 and 17 to have two different appearances
which are commonly distinguished by writing <cite>16a, 16b, 17a, 17b</cite>. In order to
stick to an integer type for the MN column, we recommend using an
additional distinguishing column which we call ‘volta’ (prima/seconda volta
being the Italian way of saying first/second ending). It has to be further
noted that, since the first volta has a length of two bars and the second
a length of only one bar, the distinuishing column does not correspond 100%
to the printed voltas. The MNs are in accordance with the
<a class="reference external" href="https://imslp.org/wiki/Special:ReverseLookup/533082">Henle Urtext Edition</a>.
The second-last timestamp has been added to the list
for clarity because in the score there is no label in MC 20.</p>
<p id="volta-numbering">In order to guarantee the display of correct measures in
MuseScore for the example above, the  following configuration has to be set for
the various MCs. A <code class="docutils literal notranslate"><span class="pre">1</span></code> in the column ‘dont_count’ represents a measure unit
for which the ‘Exclude from bar count’ flag is set and the column ‘numbering
offset’ represents values for “Add to bar number”. Empty cells represent zero
values.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 32%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>mc</p></th>
<th class="head"><p>mn</p></th>
<th class="head"><p>dont_count</p></th>
<th class="head"><p>numbering_offset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>17</p></td>
<td><p>16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>17</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>16</p></td>
<td></td>
<td><p>-2</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td><p>16</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>21</p></td>
<td><p>17</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="section" id="floating-point-timestamps">
<h4>Floating point timestamps<a class="headerlink" href="#floating-point-timestamps" title="Permalink to this headline">¶</a></h4>
<p>Bla bla</p>
</div>
</div>
</div>
<div class="section" id="the-regex-regular-expression">
<span id="regex"></span><h2>The regEx (Regular Expression)<a class="headerlink" href="#the-regex-regular-expression" title="Permalink to this headline">¶</a></h2>
<p>Is a good regEx!</p>
</div>
<div class="section" id="missing-features">
<h2>Missing Features<a class="headerlink" href="#missing-features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>encoding exact (or transposed) repetition of labels (facilitating corrections)</p></li>
<li><p>vertical segmentation of which voice/s has/have the melody</p></li>
</ul>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Harmonic Annotation Guidelines</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guidelines.html">Annotator’s Guidelines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Technical Specifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-being-encoded">What is being encoded?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#segmentations">Segmentations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timestamps">Timestamps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-regex-regular-expression">The regEx (Regular Expression)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#missing-features">Missing Features</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="guidelines.html" title="previous chapter">Annotator’s Guidelines</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, DCML.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/specs.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>