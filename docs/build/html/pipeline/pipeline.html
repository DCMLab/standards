<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DCML Corpus Creation Pipeline &#8212; Harmonic Annotation Guidelines 2.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=90673249"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script>let toggleHintShow = 'Show answer';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Annotation Reference" href="../reference/reference.html" />
    <link rel="prev" title="Quick Git Reference" href="../git/git.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          DCML Guidelines</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Other pages <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../onboarding.html">Becoming a DCML annotator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../onboarding.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../onboarding.html#working-as-an-annotator">Working as an annotator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../onboarding.html#how-to-get-involved">How to get involved</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../workflow/workflow.html">DCML annotation workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../workflow/workflow.html#short-summary">Short summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflow/workflow.html#annotating">Annotating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflow/workflow.html#upgrading-annotations">Upgrading annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflow/workflow.html#reviewing-a-set-of-annotations">Reviewing a set of annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflow/workflow.html#reacting-to-a-review-reaching-expert-consensus">Reacting to a review &amp; reaching expert consensus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workflow/workflow.html#what-to-do-about-the-warnings">What to do about the warnings?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../openproject/openproject.html">Work package management with OpenProject</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../openproject/openproject.html#user-interface">User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openproject/openproject.html#work-packages-wps">Work Packages (WPs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openproject/openproject.html#taking-on-an-assignment">Taking on an assignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openproject/openproject.html#logging-unit-costs">Logging unit costs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openproject/openproject.html#writing-invoices">Writing invoices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Annotation Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/musescore.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/first_label.html">The first label</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/first_phrase.html">The first phrase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/detail.html">Level of detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/localkey.html">Changing the local key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/counterpoint.html">Contrapuntal patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/features.html">Some more features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../git/git.html">Quick Git Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#installing-git">Installing Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#configuring-git">Configuring Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#cloning-a-repository-from-github">Cloning a Repository from GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#selecting-the-right-branch">Selecting the right Branch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#applying-changes-to-the-repository">Applying Changes to the Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#uploading-changes-to-github">Uploading Changes to GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#applying-changes-to-the-origin-directly">Applying Changes to the Origin Directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#installing-github-desktop">Installing GitHub Desktop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#first-start">First start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#cloning-a-repository">Cloning a repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git/git.html#the-user-interface">The user interface</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DCML Corpus Creation Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#collect-and-prepare-the-digital-edition-in-the-latest-musescore-format">Collect and prepare the digital edition in the latest MuseScore format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-repository-with-unannotated-musescore-files">Creating a repository with unannotated MuseScore files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-and-adding-the-new-repo">Configuring and adding the new repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#curating-and-enriching-metadata">Curating and enriching metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finalizing-a-repository-for-publication">Finalizing a repository for publication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/reference.html">Annotation Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/reference.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/reference.html#the-syntax">The syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/reference.html#the-remainder-of-the-reference-is-currently-under-reconstruction">The remainder of the Reference is currently under reconstruction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/examples.html">Questions &amp; Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/examples.html#modulation-and-secondary-keys">Modulation and Secondary Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/examples.html#phrase-structure">Phrase Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/examples.html#figured-bass">Figured Bass</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/specs.html">Technical Specifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/specs.html#what-is-being-encoded">What is being encoded?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/specs.html#the-regex-regular-expression">The regEx (Regular Expression)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/specs.html#feature-processing">Feature Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/specs.html#missing-features">Missing Features</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">This Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">DCML Corpus Creation Pipeline</a><ul>
<li><a class="reference internal" href="#collect-and-prepare-the-digital-edition-in-the-latest-musescore-format">Collect and prepare the digital edition in the latest MuseScore format</a><ul>
<li><a class="reference internal" href="#prior-research">Prior research</a></li>
<li><a class="reference internal" href="#look-up-and-check-existing-scores">Look up and check existing scores</a></li>
<li><a class="reference internal" href="#typeset-non-existent-files">Typeset non-existent files</a></li>
<li><a class="reference internal" href="#file-curation">File curation</a></li>
<li><a class="reference internal" href="#create-metadata">Create metadata</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-repository-with-unannotated-musescore-files">Creating a repository with unannotated MuseScore files</a><ul>
<li><a class="reference internal" href="#variant-1-using-the-template-repository">Variant 1: Using the template repository</a></li>
<li><a class="reference internal" href="#variant-2-starting-from-scratch">Variant 2: Starting from scratch</a></li>
<li><a class="reference internal" href="#variant-3-splitting-an-existing-repository">Variant 3: Splitting an existing repository</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-and-adding-the-new-repo">Configuring and adding the new repo</a><ul>
<li><a class="reference internal" href="#adding-the-repo-to-one-or-several-meta-repos">Adding the repo to one or several meta-repos</a></li>
<li><a class="reference internal" href="#creating-work-packages-on-openproject">Creating work packages on OpenProject</a></li>
</ul>
</li>
<li><a class="reference internal" href="#curating-and-enriching-metadata">Curating and enriching metadata</a><ul>
<li><a class="reference internal" href="#default-fields">Default fields</a></li>
<li><a class="reference internal" href="#required-custom-fields">Required custom fields</a></li>
<li><a class="reference internal" href="#identifiers-where-available">Identifiers where available</a></li>
<li><a class="reference internal" href="#contributors-and-annotations">Contributors and annotations</a></li>
<li><a class="reference internal" href="#reconciling-metadata-with-wikidata">Reconciling metadata with Wikidata</a><ul>
<li><a class="reference internal" href="#creating-a-new-openrefine-project">Creating a new OpenRefine project</a></li>
<li><a class="reference internal" href="#reconciling-a-column">Reconciling a column</a></li>
<li><a class="reference internal" href="#reconciling-the-worktitle-column">Reconciling the <code class="docutils literal notranslate"><span class="pre">workTitle</span></code> column</a></li>
<li><a class="reference internal" href="#pulling-additional-information">Pulling additional information</a></li>
<li><a class="reference internal" href="#future-work-sub-work-level-items">Future work: Sub-work-level items</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#finalizing-a-repository-for-publication">Finalizing a repository for publication</a><ul>
<li><a class="reference internal" href="#finalize-ongoing-work">Finalize ongoing work</a><ul>
<li><a class="reference internal" href="#check-openproject">0. Check OpenProject</a></li>
<li><a class="reference internal" href="#addressing-open-pull-requests">1. Addressing open Pull Requests</a></li>
<li><a class="reference internal" href="#check-for-unmerged-branches">2. Check for unmerged branches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#update-repository-structure">Update repository structure</a><ul>
<li><a class="reference internal" href="#create-a-version-tag">3. Create a version tag</a></li>
<li><a class="reference internal" href="#remove-the-automated-github-workflow-and-all-deprecated-files">4. Remove the automated GitHub workflow and all deprecated files</a></li>
<li><a class="reference internal" href="#update-the-extracted-files-to-ms3-version-2">5. Update the extracted files to ms3 version 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#eliminating-all-warnings">Eliminating all warnings</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../git/git.html" title="Previous Chapter: Quick Git Reference"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Quick Git Reference</span>
    </a>
  </li>
  <li>
    <a href="../reference/reference.html" title="Next Chapter: Annotation Reference"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Annotation Reference &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/pipeline/pipeline.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="dcml-corpus-creation-pipeline">
<h1>DCML Corpus Creation Pipeline<a class="headerlink" href="#dcml-corpus-creation-pipeline" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#collect-and-prepare-the-digital-edition-in-the-latest-musescore-format" id="id13">Collect and prepare the digital edition in the latest MuseScore format</a></p>
<ul>
<li><p><a class="reference internal" href="#prior-research" id="id14">Prior research</a></p></li>
<li><p><a class="reference internal" href="#look-up-and-check-existing-scores" id="id15">Look up and check existing scores</a></p></li>
<li><p><a class="reference internal" href="#typeset-non-existent-files" id="id16">Typeset non-existent files</a></p></li>
<li><p><a class="reference internal" href="#file-curation" id="id17">File curation</a></p></li>
<li><p><a class="reference internal" href="#create-metadata" id="id18">Create metadata</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#creating-a-repository-with-unannotated-musescore-files" id="id19">Creating a repository with unannotated MuseScore files</a></p>
<ul>
<li><p><a class="reference internal" href="#variant-1-using-the-template-repository" id="id20">Variant 1: Using the template repository</a></p></li>
<li><p><a class="reference internal" href="#variant-2-starting-from-scratch" id="id21">Variant 2: Starting from scratch</a></p></li>
<li><p><a class="reference internal" href="#variant-3-splitting-an-existing-repository" id="id22">Variant 3: Splitting an existing repository</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuring-and-adding-the-new-repo" id="id23">Configuring and adding the new repo</a></p>
<ul>
<li><p><a class="reference internal" href="#adding-the-repo-to-one-or-several-meta-repos" id="id24">Adding the repo to one or several meta-repos</a></p></li>
<li><p><a class="reference internal" href="#creating-work-packages-on-openproject" id="id25">Creating work packages on OpenProject</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#curating-and-enriching-metadata" id="id26">Curating and enriching metadata</a></p>
<ul>
<li><p><a class="reference internal" href="#default-fields" id="id27">Default fields</a></p></li>
<li><p><a class="reference internal" href="#required-custom-fields" id="id28">Required custom fields</a></p></li>
<li><p><a class="reference internal" href="#identifiers-where-available" id="id29">Identifiers where available</a></p></li>
<li><p><a class="reference internal" href="#contributors-and-annotations" id="id30">Contributors and annotations</a></p></li>
<li><p><a class="reference internal" href="#reconciling-metadata-with-wikidata" id="id31">Reconciling metadata with Wikidata</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-a-new-openrefine-project" id="id32">Creating a new OpenRefine project</a></p></li>
<li><p><a class="reference internal" href="#reconciling-a-column" id="id33">Reconciling a column</a></p></li>
<li><p><a class="reference internal" href="#reconciling-the-worktitle-column" id="id34">Reconciling the <code class="docutils literal notranslate"><span class="pre">workTitle</span></code> column</a></p></li>
<li><p><a class="reference internal" href="#pulling-additional-information" id="id35">Pulling additional information</a></p></li>
<li><p><a class="reference internal" href="#future-work-sub-work-level-items" id="id36">Future work: Sub-work-level items</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#finalizing-a-repository-for-publication" id="id37">Finalizing a repository for publication</a></p>
<ul>
<li><p><a class="reference internal" href="#finalize-ongoing-work" id="id38">Finalize ongoing work</a></p>
<ul>
<li><p><a class="reference internal" href="#check-openproject" id="id39">0. Check OpenProject</a></p></li>
<li><p><a class="reference internal" href="#addressing-open-pull-requests" id="id40">1. Addressing open Pull Requests</a></p></li>
<li><p><a class="reference internal" href="#check-for-unmerged-branches" id="id41">2. Check for unmerged branches</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#update-repository-structure" id="id42">Update repository structure</a></p>
<ul>
<li><p><a class="reference internal" href="#create-a-version-tag" id="id43">3. Create a version tag</a></p></li>
<li><p><a class="reference internal" href="#remove-the-automated-github-workflow-and-all-deprecated-files" id="id44">4. Remove the automated GitHub workflow and all deprecated files</a></p></li>
<li><p><a class="reference internal" href="#update-the-extracted-files-to-ms3-version-2" id="id45">5. Update the extracted files to ms3 version 2</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#eliminating-all-warnings" id="id46">Eliminating all warnings</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="collect-and-prepare-the-digital-edition-in-the-latest-musescore-format">
<span id="get-scores"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink">Collect and prepare the digital edition in the latest MuseScore format</a><a class="headerlink" href="#collect-and-prepare-the-digital-edition-in-the-latest-musescore-format" title="Permalink to this heading">¶</a></h2>
<section id="prior-research">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Prior research</a><a class="headerlink" href="#prior-research" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Check which pieces make up the collection</p></li>
<li><p>how they are grouped</p></li>
<li><p>what naming or numbering conventions exist</p></li>
<li><p>which editions there are</p></li>
<li><p>if different versions of the pieces exist.</p></li>
<li><p>Come up with a list (and hierarchy) of names. Here, you can already think of a good naming/numbering convention for the corpus.</p></li>
<li><p>It might be good to create the list of the overarching group of works even if your corpus will contain only parts of it, for the sake of a better overview.</p></li>
<li><p>Example: Going from the <a class="reference external" href="http://www3.cpdl.org/wiki/index.php/Claudio_Monteverdi">list of Monteverdi’s Madrigal books</a>
to an <a class="reference external" href="https://github.com/DCMLab/monteverdi_madrigals/">initial README file</a>.</p></li>
</ul>
</section>
<section id="look-up-and-check-existing-scores">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Look up and check existing scores</a><a class="headerlink" href="#look-up-and-check-existing-scores" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>All scores available need to be checked and compared:</dt><dd><ul>
<li><p>reference edition</p></li>
<li><p>completeness</p></li>
<li><p>quality &amp; errors</p></li>
<li><p>license (later publication!)</p></li>
<li><p>file format and expected conversion losses</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Where to check</dt><dd><ul>
<li><p>First: musescore.com because the scores are in the target format</p></li>
<li><p>musicalion.com (not free to publish: need to ask first)</p></li>
<li><p>choral music: CPDL</p></li>
<li><p><a class="reference external" href="http://kern.ccarh.org/">http://kern.ccarh.org/</a> lossless humdrum 2 musescore conversion needed</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="typeset-non-existent-files">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Typeset non-existent files</a><a class="headerlink" href="#typeset-non-existent-files" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>pick reference edition and send commission to transcriber</p></li>
<li><p>depending on the music, prices may vary between 5 and 20 CHF per page</p></li>
</ul>
</section>
<section id="file-curation">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">File curation</a><a class="headerlink" href="#file-curation" title="Permalink to this heading">¶</a></h3>
<p>The scores need to be corrected on the basis of a reference edition/manuscript.
We have a collaborative document with detailed
<a class="reference external" href="https://docs.google.com/document/d/1Q2svEUSsE7OCetik8An__gsEwQCYNfFJlHFMF9dRce4/edit#heading=h.8hrcm7m3udll">Score correction guidelines</a>.
It also stipulates which information from the reference edition/manuscript needs to be encoded in what way.
Please send a request to be added to the document.</p>
<ul class="simple">
<li><dl class="simple">
<dt>Convert to MuseScore format</dt><dd><ul>
<li><p>XML, CAP: can be done with MuseScore’s batch converter plugin or with <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">convert</span></code></p></li>
<li><p>CAPX: Conversion to CAP or XML with DCML’s Capella license</p></li>
<li><p>MUSX: Conversion to XML with private Finale copy</p></li>
<li><p>SIB: Conversion to XML with Sibelius on DCML’s iMac</p></li>
<li><p>LY: no good conversion available</p></li>
<li><p>KRN: hum2xml can be used but it would be preferable to have our own converter to MuseScore</p></li>
<li><p>results need to be checked; especially markup such as slurs, arpeggios, trills etc. often get screwed</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Renaming</dt><dd><ul>
<li><p>Decide on naming convention and create a map (without extensions) from old to new filenames</p></li>
<li><dl class="simple">
<dt>Sometimes, files need to be split at that point because they contain several movements</dt><dd><ul>
<li><p>For this, you introduce section breaks separating the movements</p></li>
<li><p>After every section break, you have to re-insert the time and key signature or add it into the split file</p></li>
<li><p>Start with the last movement, select it and do <cite>File -&gt; Save Selection</cite></p></li>
<li><p>Repeat for all movements</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Rename the files</p></li>
<li><p>Possibly add a small script that automatically renames the source files</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Use parser/checking tool and/or manual checks for consistency</dt><dd><ul>
<li><dl class="simple">
<dt>certain bars need to be excluded from the bar count:</dt><dd><ul>
<li><p>anacrusis</p></li>
<li><p>pickup measures throughout the piece</p></li>
<li><p>second voltas (i.e. second repeats)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>irregular measure lengths need to complete each other</dt><dd><ul>
<li><p>e.g. when a repeated section starts with a pickup measure, the last measure of the repeated section needs to be shorter</p></li>
<li><p>anacrusis is substracted from the last bar</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if in the reference edition the bar count restarts in the middle of the piece (e.g. in some variation movements), you can</dt><dd><ul>
<li><p>either: split the movement into individual files (not preferable if you want to keep the movement as one coherent unit)</p></li>
<li><p>or: have two versions, one working version with continuous (unambiguous) measure numbers that depart from the reference edition, and one that is provided separately, that has the original (ambiguous) measure numbering but is not used for computational purposes. The reset of the counter should not be done via “add to measure count” using a negative number, but rather via section breaks.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="create-metadata">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Create metadata</a><a class="headerlink" href="#create-metadata" title="Permalink to this heading">¶</a></h3>
<p>All metadata fields are automatically extracted by the dcml_corpus_workflow and represented in the repository’s
<code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> file. However, at the beginning this file needs to be created using the command <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">extract</span> <span class="pre">-D</span> <span class="pre">-a</span></code>.
The first column, <code class="docutils literal notranslate"><span class="pre">fname</span></code>, is used as IDs for the corpus and needs to be checked. In case the corpus contains
several alternative scores for the same piece, the main MuseScore file should have the shortest file name and the
alternative scores’ file names should begin with the same <code class="docutils literal notranslate"><span class="pre">fname</span></code> plus a suffix or a different file extension.
Upon creation of the <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> file, all scores will be listed and you can safely remove the rows corresponding
to the alternative versions to prevent them being processed by ms3.</p>
<p>Once the <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> is there and contains one row per piece, metadata curation is as straightforward as
updating values and adding columns to the file and then calling
<code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">metadata</span></code> to write the updated values into the corresponding Musescore files. Be aware that calling
<code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">extract</span> <span class="pre">-D</span></code> will overwrite the manual changes in the TSV file with any value existing in the MuseScore files.
so make sure to commit your manual modifications to not loose them.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Although many editors open TSV files, many of them silently change values, e.g. by removing
<code class="docutils literal notranslate"><span class="pre">.0</span></code> from decimal values (LibreOffice) or turning a <code class="docutils literal notranslate"><span class="pre">4/4</span></code> time signature into a date (Excel,
Numbers). One editor that doesn’t to that is VScode. Make sure to <strong>always</strong> view the diff before
committing changes to <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> to avoid unwanted modifications or, worse, loss of data.</p>
</div>
<p>Once the <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> is there and contains one row per piece, you can either continue with the following section
and create the new Git repository or <a class="reference internal" href="#enriching-metadata"><span class="std std-ref">enrich the metadata</span></a> first. Since enriching metadata
involves modifying the scores, however, it is preferable to make metadata curation part of the Git history.</p>
</section>
</section>
<section id="creating-a-repository-with-unannotated-musescore-files">
<span id="score-repo"></span><h2><a class="toc-backref" href="#id19" role="doc-backlink">Creating a repository with unannotated MuseScore files</a><a class="headerlink" href="#creating-a-repository-with-unannotated-musescore-files" title="Permalink to this heading">¶</a></h2>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>After we start the annotation workflow, no MuseScore files should be added. removed, or renamed! The edition
needs to be complete and the file names final.</p>
</div>
<p>Before starting annotating a corpus, a repo with the standard folder structure needs to be created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── MS3
└── pdf
</pre></div>
</div>
<p>The directory <code class="docutils literal notranslate"><span class="pre">MS3</span></code> contains the unannotated MuseScore files and <code class="docutils literal notranslate"><span class="pre">PDF</span></code> the print edition or manuscript which they
encode. In order to activate the annotation workflow (i.e. the automatic scripts triggered on the GitHub servers
by certain events related to annotation and review), the folder <code class="docutils literal notranslate"><span class="pre">.github/workflows</span></code> needs to be copied from
the <a class="reference external" href="https://github.com/DCMLab/annotation_workflow_template">template repository</a>. It also contains our
standard <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> file which prevents temporary files from being tracked and uploaded.</p>
<section id="variant-1-using-the-template-repository">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Variant 1: Using the template repository</a><a class="headerlink" href="#variant-1-using-the-template-repository" title="Permalink to this heading">¶</a></h3>
<p>You can create the new repo directly from the <a class="reference external" href="https://github.com/DCMLab/annotation_workflow_template">template repository</a>
by heading there and clicking on ‘Use this template’. In this variant, every push to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch results
in metadata, measures and notes being extracted from all changed <code class="docutils literal notranslate"><span class="pre">.mscx</span></code> files. Note that renaming and deleting
files will lead to undesired effects that will have to be checked and corrected manually.</p>
</section>
<section id="variant-2-starting-from-scratch">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Variant 2: Starting from scratch</a><a class="headerlink" href="#variant-2-starting-from-scratch" title="Permalink to this heading">¶</a></h3>
<p>Or you simply create the new repo with the above-mentioned folder structure and add the workflow scripts when
the scores are prepared. In this case, you will have to use the <a class="reference external" href="https://pypi.org/project/ms3">Python library ms3</a>
to extract metadata, notes, and measures manually.</p>
</section>
<section id="variant-3-splitting-an-existing-repository">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Variant 3: Splitting an existing repository</a><a class="headerlink" href="#variant-3-splitting-an-existing-repository" title="Permalink to this heading">¶</a></h3>
<p>This is for the special case that the MuseScore files in question are already sitting in a subfolder of an existing
repository which is to be transferred into the new repo including the files’ Git histories. This variant is a bit
more involved and requires prior installation of the <a class="reference external" href="https://github.com/newren/git-filter-repo">git filter-repo</a>
command which is recommended by the Git developers for replacing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">filter-branch</span></code>.</p>
<dl>
<dt>Setting</dt><dd><p>As an example, we will create a new repository <code class="docutils literal notranslate"><span class="pre">chopin_mazurkas</span></code> (Repo B) which will include all files situated in the
existing repository <code class="docutils literal notranslate"><span class="pre">corpora</span></code> (Repo A) in the subfolder <code class="docutils literal notranslate"><span class="pre">annotations/Chopin-Mazurkas</span></code>, with the workflow scripts
added on top.</p>
</dd>
<dt>Create the new repo B</dt><dd><p>On GitHub, we use the <a class="reference external" href="https://github.com/DCMLab/annotation_workflow_template">template repository</a> to create
the target repo <code class="docutils literal notranslate"><span class="pre">chopin_mazurkas</span></code> with the workflow files and the standard <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code>. Locally, we initialize
an empty Git repo that will be connected upstream at a later point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">chopin_mazurkas</span> <span class="o">&amp;&amp;</span> <span class="n">cd</span> <span class="n">chopin_mazurkas</span> <span class="o">&amp;&amp;</span> <span class="n">git</span> <span class="n">init</span>
</pre></div>
</div>
<p>Make sure that your Git is configured to use the name <code class="docutils literal notranslate"><span class="pre">main</span></code> for the default branch, which can be achieved using
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span> <span class="pre">--global</span> <span class="pre">init.defaultBranch</span> <span class="pre">main</span></code>.</p>
</dd>
<dt>Clone repo A and transfer files</dt><dd><p>We start off with a fresh clone of <code class="docutils literal notranslate"><span class="pre">corpora</span></code>, head into it and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="nb">filter</span><span class="o">-</span><span class="n">repo</span> <span class="o">--</span><span class="n">subdirectory</span><span class="o">-</span><span class="nb">filter</span> <span class="n">annotations</span><span class="o">/</span><span class="n">Chopin</span><span class="o">-</span><span class="n">Mazurkas</span><span class="o">/</span> <span class="o">--</span><span class="n">target</span> <span class="o">../</span><span class="n">chopin_mazurkas</span>
</pre></div>
</div>
<p>which will copy all files from <code class="docutils literal notranslate"><span class="pre">annotations/Chopin-Mazurkas/</span></code> to the freshly initialized repo
<code class="docutils literal notranslate"><span class="pre">chopin_mazurkas</span></code> together with their full commit histories. If there is a README file, rename it to <code class="docutils literal notranslate"><span class="pre">README.md</span></code>.</p>
</dd>
<dt>Connect local repo B to the remote repo B</dt><dd><p>The local <code class="docutils literal notranslate"><span class="pre">chopin_mazurkas</span></code> now contains the files at the top level together with the full commit
history (check out <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>). Now we can connect it to the remote and merge the workflow scripts from there:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">origin</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">DCMLab</span><span class="o">/</span><span class="n">chopin_mazurkas</span><span class="o">.</span><span class="n">git</span>
<span class="n">git</span> <span class="n">pull</span> <span class="n">origin</span> <span class="n">main</span> <span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">unrelated</span><span class="o">-</span><span class="n">histories</span>
<span class="n">git</span> <span class="n">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">origin</span> <span class="n">main</span>
</pre></div>
</div>
</dd>
<dt>Clean metadata</dt><dd><p>In case there was an older <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> it should now be automatically updated and you might have to clean it.
This may involve naming the first two columns <code class="docutils literal notranslate"><span class="pre">rel_paths</span></code> and <code class="docutils literal notranslate"><span class="pre">fnames</span></code>. For the Mazurka example,
<a class="reference external" href="https://github.com/DCMLab/chopin_mazurkas/pull/1">this Pull Request</a> shows the metadata cleaning and update
of the existing files from an older MuseScore and annotation standard.</p>
</dd>
</dl>
</section>
</section>
<section id="configuring-and-adding-the-new-repo">
<h2><a class="toc-backref" href="#id23" role="doc-backlink">Configuring and adding the new repo</a><a class="headerlink" href="#configuring-and-adding-the-new-repo" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>Set the standard repo settings on GitHub:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/pr_settings.png"><img alt="Repository settings on GitHub" src="../_images/pr_settings.png" style="width: 395.0px; height: 239.0px;" /></a>
</figure>
</li>
<li><p>Under <code class="docutils literal notranslate"><span class="pre">Branches</span></code>, create a branch protection rule for the main branch:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/branch_protection.png"><img alt="Protecting the main branch on GitHub" src="../_images/branch_protection.png" style="width: 392.0px; height: 250.0px;" /></a>
</figure>
</li>
<li><p>Under <code class="docutils literal notranslate"><span class="pre">Collaborators</span> <span class="pre">and</span> <span class="pre">teams</span></code> give write access to the <code class="docutils literal notranslate"><span class="pre">annotators</span></code> team.</p></li>
<li><p>Under <code class="docutils literal notranslate"><span class="pre">Pages</span></code> set the Source to the root <code class="docutils literal notranslate"><span class="pre">/</span></code> of the branch <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> (which should have been
automatically created by the workflow when pushing the first MuseScore files). Add the page’s URL as the
repo’s website.</p></li>
<li><p>Add the new repo to the corresponding meta-repositories (at least to <code class="docutils literal notranslate"><span class="pre">all_subcorpora</span></code>, see below).</p></li>
<li><p>Add the new repo to the annotation workflow (drop-down menus, OpenProject, WebHooks etc.)</p></li>
</ul>
<section id="adding-the-repo-to-one-or-several-meta-repos">
<span id="metarepos"></span><h3><a class="toc-backref" href="#id24" role="doc-backlink">Adding the repo to one or several meta-repos</a><a class="headerlink" href="#adding-the-repo-to-one-or-several-meta-repos" title="Permalink to this heading">¶</a></h3>
<p>The individual subcorpora can be embedded as submodules in meta-repositories. These meta-repos are listed in the private
<a class="reference external" href="https://github.com/DCMLab/meta_repositories">meta_repositories</a> repo. Currently, the most important ones are:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/DCMLab/dcml_corpora">dcml_corpora</a> for published corpora</p></li>
<li><p><a class="reference external" href="https://github.com/DCMLab/all_subcorpora">all_subcorpora</a> (private) for all published and unpublished corpora.</p></li>
</ol>
<p>To add the new repo, head into the meta-repo and do</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">submodule</span> <span class="n">add</span> <span class="o">-</span><span class="n">b</span> <span class="n">main</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">DCMLab</span><span class="o">/</span><span class="n">chopin_mazurkas</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Just to be sure, update all submodules: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span> <span class="pre">--remote</span></code> and push the whole thing.</p>
</section>
<section id="creating-work-packages-on-openproject">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Creating work packages on OpenProject</a><a class="headerlink" href="#creating-work-packages-on-openproject" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Follow the instructions for <cite>create_work_packages.py</cite> under <a class="reference external" href="https://github.com/DCMLab/openproject_scripts/">https://github.com/DCMLab/openproject_scripts/</a></p>
<ul class="simple">
<li><p>set the column <code class="docutils literal notranslate"><span class="pre">parent</span></code> to the name of the repository</p></li>
<li><p>rename the columns <code class="docutils literal notranslate"><span class="pre">fnames</span> <span class="pre">=&gt;</span> <span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">last_mn</span> <span class="pre">=&gt;</span> <span class="pre">measures</span></code></p></li>
<li><p>if the new work packages are for annotation upgrades rather than new annotations, add the column <code class="docutils literal notranslate"><span class="pre">work_package_type</span></code>
with value <code class="docutils literal notranslate"><span class="pre">Annotation</span> <span class="pre">Upgrade</span></code></p></li>
<li><p>find out the status of all pieces and fill the column <code class="docutils literal notranslate"><span class="pre">status</span></code>. Accordingly:</p></li>
<li><p>if annotations are present and need to be updated, rename <code class="docutils literal notranslate"><span class="pre">annotators</span> <span class="pre">=&gt;</span> <span class="pre">reviewer</span></code> and make sure that every cell contains exactly one
user name (<code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">Last</span></code>) known to OpenProject;</p></li>
<li><p>if review is done or ongoing, do the same for the renamed column <code class="docutils literal notranslate"><span class="pre">reviewers</span> <span class="pre">=&gt;</span> <span class="pre">reviewer</span></code></p></li>
<li><p>if annotations are present and finalized, the work package, in theory, does not need to be created; if it is,
it should have status “Not available”. Filling the fields <code class="docutils literal notranslate"><span class="pre">assignee</span></code> and <code class="docutils literal notranslate"><span class="pre">reviewer</span></code>, is not needed unless for invoicing purposes</p></li>
</ul>
</li>
<li><p>Create a new view in OpenProject:</p>
<ul class="simple">
<li><p>open any of the existing corpora views</p></li>
<li><p>replace the <code class="docutils literal notranslate"><span class="pre">Parent</span></code> filter with the repo name</p></li>
<li><p>in the menu, select <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">as...</span></code></p></li>
<li><p>enter the repo name and check <code class="docutils literal notranslate"><span class="pre">Public</span></code></p></li>
</ul>
</li>
<li><p>Add the webhook to the repo</p>
<ul class="simple">
<li><p>go to a repo for which the webhook is already set up</p></li>
<li><p>in the repo settings, go to <code class="docutils literal notranslate"><span class="pre">Webhooks</span></code>, click <code class="docutils literal notranslate"><span class="pre">Edit</span></code>, and copy the <code class="docutils literal notranslate"><span class="pre">Payload</span> <span class="pre">URL</span></code></p></li>
<li><p>in the new repo, go to <code class="docutils literal notranslate"><span class="pre">Settings</span> <span class="pre">-&gt;</span> <span class="pre">Webhooks</span> <span class="pre">-&gt;</span> <span class="pre">Add</span> <span class="pre">webhook</span></code> and insert the copied <code class="docutils literal notranslate"><span class="pre">Payload</span> <span class="pre">URL</span></code></p></li>
<li><p>set the <code class="docutils literal notranslate"><span class="pre">Content</span> <span class="pre">type</span></code> to “application/json”</p></li>
<li><p>Below, select “Send me <strong>everything</strong>” and click <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">webhook</span></code></p></li>
</ul>
</li>
<li><p>Add the new work packages to the master sheet for the administrative staff</p></li>
</ol>
</section>
</section>
<section id="curating-and-enriching-metadata">
<span id="enriching-metadata"></span><h2><a class="toc-backref" href="#id26" role="doc-backlink">Curating and enriching metadata</a><a class="headerlink" href="#curating-and-enriching-metadata" title="Permalink to this heading">¶</a></h2>
<p>In MuseScore, metadata is stored as <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">-&gt;</span> <span class="pre">value</span></code> pairs and can be accessed and modified via the menu
<code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">-&gt;</span> <span class="pre">Score</span> <span class="pre">Properties...</span></code>. Some fields are there by default, others have to be created using the <code class="docutils literal notranslate"><span class="pre">New</span></code> button.
It is very important that the fields are named correctly (double-check for spelling mistakes) and all lowercase.
The command <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">extract</span> <span class="pre">-D</span></code> extracts the metadata fields from the MuseScore files, updating the
<code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> file in a way that every row corresponds to a MuseScore file where every <code class="docutils literal notranslate"><span class="pre">key</span></code> is a column showing
the <code class="docutils literal notranslate"><span class="pre">value</span></code> from the corresponding file. Likewise, this can be used to batch-edit the metadata of several or all
MuseScore files in the corpus by editing the <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> file and calling the command <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">metadata</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before manipulating <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> make sure to call <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">extract</span> <span class="pre">-D</span></code>, ensuring that it is up to date
with the metadata contained in the MuseScore files. Otherwise the command <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">metadata</span></code> would overwrite
newer values, resulting in the criminal offense of undoing other people’s work.</p>
</div>
<p>DCML corpora usually come with one MuseScore file per movement, hence we follow the convention that anything related to
<code class="docutils literal notranslate"><span class="pre">work</span></code> describes the whole group (Suite, Symphony, etc.) or cycle (e.g. song cycle), and fields containing
<code class="docutils literal notranslate"><span class="pre">movement</span></code> or <code class="docutils literal notranslate"><span class="pre">mvt</span></code> its individual parts. It follows that in the <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> file titles, catalogue numbers,
URIs etc. are repeated and identical for the parts of a <code class="docutils literal notranslate"><span class="pre">work</span></code>. Identifiers for individual movements are often
hard to come by, but musicbrainz has already a good number of them. For compositions where the subdivision into
parts is somewhat arbitrary (consider the grouping into tracks for recordings of the same opera), the question of
unique identification is an open problem.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Whereas in filenames we avoid all diacritical signs, accents, Umlaute etc., the metadata needs to include them
accurately encoded in UTF-8. For example, write <code class="docutils literal notranslate"><span class="pre">Antonín</span> <span class="pre">Dvořák</span></code>, not <code class="docutils literal notranslate"><span class="pre">Antonin</span> <span class="pre">Dvorak</span></code>. Whenever in doubt,
go with the English Wikidata/Wikipedia.</p>
</div>
<section id="default-fields">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Default fields</a><a class="headerlink" href="#default-fields" title="Permalink to this heading">¶</a></h3>
<p>The following default fields should be populated where applicable:</p>
<dl class="simple">
<dt>composer</dt><dd><p>Full name as displayed in the English Wikipedia. For example,
<a class="reference external" href="https://en.wikipedia.org/wiki/Pyotr_Ilyich_Tchaikovsky">Tchaikovsky</a> gets <code class="docutils literal notranslate"><span class="pre">Pyotr</span> <span class="pre">Ilyich</span> <span class="pre">Tchaikovsky</span></code>.</p>
</dd>
<dt>workTitle</dt><dd><p>Name of the entire work/cycle, e.g. <code class="docutils literal notranslate"><span class="pre">Winterreise</span></code> or <code class="docutils literal notranslate"><span class="pre">Piano</span> <span class="pre">Sonata</span> <span class="pre">No.</span> <span class="pre">1</span> <span class="pre">in</span> <span class="pre">C</span> <span class="pre">major</span></code> without any catalogue
or opus numbers. The title should largely correspond to the English <code class="docutils literal notranslate"><span class="pre">label</span></code> of the corresponding (or future)
Wikidata item.</p>
</dd>
<dt>workNumber</dt><dd><p>This is where opus and catalogue numbers go, e.g. <code class="docutils literal notranslate"><span class="pre">Op.</span> <span class="pre">33,</span> <span class="pre">No.</span> <span class="pre">3,</span> <span class="pre">BI</span> <span class="pre">115-3</span></code>.</p>
</dd>
<dt>movementNumer</dt><dd><p>Ordinal number of the movement or part. Should be an arabic integer, e.g. <code class="docutils literal notranslate"><span class="pre">2</span></code> (not <code class="docutils literal notranslate"><span class="pre">2.</span></code>, not <code class="docutils literal notranslate"><span class="pre">II</span></code>).</p>
</dd>
<dt>movementTitle</dt><dd><p>Title of the part, e.g. song title, or <code class="docutils literal notranslate"><span class="pre">Andante</span></code> (not <code class="docutils literal notranslate"><span class="pre">II.</span> <span class="pre">Andante</span></code>). If unclear, CD track titles might serve
as an orientation.</p>
</dd>
<dt>source</dt><dd><p>URL of the adapted digital edition, e.g. a link to musescore.com or kern.humdrum.org.</p>
</dd>
</dl>
</section>
<section id="required-custom-fields">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Required custom fields</a><a class="headerlink" href="#required-custom-fields" title="Permalink to this heading">¶</a></h3>
<p>The following fields need to be populated.</p>
<dl id="composition-year-columns">
<dt>composed_start, composed_end</dt><dd><p>Each of these two fields needs to contain a 4-digit year number such that taken together they represent the time span
during which the piece was composed according to <code class="docutils literal notranslate"><span class="pre">composed_source</span></code>. If the time span lies within the same year,
both fields contain the same number. If the source indicates an open interval (e.g. <code class="docutils literal notranslate"><span class="pre">?-1789</span></code>), we use the
<a class="reference external" href="https://www.loc.gov/standards/datetime/">EDTF</a> convention to indicate the unknown date (here <code class="docutils literal notranslate"><span class="pre">composed_start</span></code>)
as <code class="docutils literal notranslate"><span class="pre">..</span></code>. If no composition date is known, we use the following dates as fallback, in that order:</p>
<ol class="arabic simple">
<li><p>year of the princeps edition</p></li>
<li><p>musicologically informed time span (e.g. the composer’s “sad phase” from x-y)</p></li>
<li><p>composer’s life span</p></li>
</ol>
<p>In any of these cases, an explaining comment should be added to the <code class="docutils literal notranslate"><span class="pre">composed_source</span></code> field.</p>
</dd>
<dt>composed_source</dt><dd><p>The reference to where the <code class="docutils literal notranslate"><span class="pre">composed_start</span></code> and <code class="docutils literal notranslate"><span class="pre">composed_end</span></code> dates come from. Could be a URL such as
<a class="reference external" href="https://en.wikipedia.org/wiki/List_of_compositions_by_Edvard_Grieg">https://en.wikipedia.org/wiki/List_of_compositions_by_Edvard_Grieg</a>, the name of a dictionary or work catalogue,
or bibliographical data of a book. The latter would be required in the case of using a “musicologically informed
time span” (see above). This field is free text and, in the absence of composition dates, should contain additional
information on what exactly the years represent, e.g.
<code class="docutils literal notranslate"><span class="pre">dates</span> <span class="pre">represent</span> <span class="pre">the</span> <span class="pre">&quot;late</span> <span class="pre">period&quot;</span> <span class="pre">of</span> <span class="pre">composer</span> <span class="pre">X's</span> <span class="pre">work,</span> <span class="pre">as</span> <span class="pre">proposed</span> <span class="pre">by</span> <span class="pre">author</span> <span class="pre">Y</span> <span class="pre">in</span> <span class="pre">book</span> <span class="pre">Z,</span> <span class="pre">page</span> <span class="pre">n</span></code>.</p>
</dd>
</dl>
</section>
<section id="identifiers-where-available">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Identifiers where available</a><a class="headerlink" href="#identifiers-where-available" title="Permalink to this heading">¶</a></h3>
<p>Identifiers are important for making data findable and interoperable but might not always be available. Nevertheless,
the goal should be to find minimum one of the work or part-of-work identifiers listed below. Wikidata identifiers
are the gold standard because they often come with a mapping to all other kinds of identifiers. In addition,
Wikidata is a knowledge graph which lets us easily pull additional metadata. The site has the drawback
that identifiers for less known works are mostly missing as of yet and so are identifiers for individual movements.
Until the fundamental problem of community-wide work identifiers is solved, we should aim at completing missing
Wikidata items and foster the graph’s function as a Linked Open Data hub and registry for all other sorts of
identifiers.</p>
<dl class="simple">
<dt>wikidata</dt><dd><p>This field is used to identify the <code class="docutils literal notranslate"><span class="pre">work</span></code> with the full URL of its corresponding Wikidata item, e.g.
<a class="reference external" href="http://www.wikidata.org/entity/Q2194957">http://www.wikidata.org/entity/Q2194957</a>. If the <code class="docutils literal notranslate"><span class="pre">composer</span></code> and <code class="docutils literal notranslate"><span class="pre">workTitle</span></code> field are properly filled in,
they can be reconciled with, i.e. matched to,
Wikidata <a class="reference external" href="https://openrefine.org/docs/manual/reconciling">using OpenRefine</a>.</p>
</dd>
<dt>musicbrainz</dt><dd><p>musicbrainz.org has a whole lot of different identifiers, in particular for identifying individual recordings down
to the level of CD tracks. The ones we’re interested here are work identifiers (make sure the URI starts with
<code class="docutils literal notranslate"><span class="pre">https://musicbrainz.org/work/</span></code>). The project is very advanced with creating identifiers on the
sub-work (movement) level and we use those whenever available (see screenshot below).
If not, we repeat the work ID for each movement.</p>
</dd>
</dl>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/musicbrainz_work.png"><img alt="Example for a work displayed on musicbrainz." src="../_images/musicbrainz_work.png" style="width: 534.8px; height: 387.09999999999997px;" /></a>
<figcaption>
<p><span class="caption-text">Example of a work displayed on musicbrainz (note the URL). In this case, it lists identifiers for its three
movements so we would be using these.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<dl class="simple">
<dt>viaf</dt><dd><p>Work URI, e.g. <a class="reference external" href="https://viaf.org/viaf/181040674">https://viaf.org/viaf/181040674</a></p>
</dd>
<dt>imslp</dt><dd><p>URL of the work’s Wiki page, e.g.
<a class="reference external" href="https://imslp.org/wiki/Piano_Sonata_No.1_in_C_major%2C_K.279/189d_%28Mozart%2C_Wolfgang_Amadeus%29">https://imslp.org/wiki/Piano_Sonata_No.1_in_C_major%2C_K.279/189d_%28Mozart%2C_Wolfgang_Amadeus%29</a></p>
</dd>
<dt>pdf</dt><dd><p>We use this field, if applicable and available, to store the permanent link to the source PDF which the
digital score is supposed to represent. Most often this will be an IMSLP “permlink” pointing to a particular
edition through its ID, such as <a class="reference external" href="https://imslp.org/wiki/Special:ReverseLookup/1689">https://imslp.org/wiki/Special:ReverseLookup/1689</a> (the corresponding PDF file
name starts with <code class="docutils literal notranslate"><span class="pre">IMSLP01689</span></code>). Such a permlink is available via the edition’s menu, by clicking on
<code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">permlink</span></code>.</p>
</dd>
<dt>P&lt;number&gt; (&lt;description&gt;)</dt><dd><p>Columns with a Wikidata “P-number” are used for storing a reconciliation with the Wikidata knowledge graph. For
example, the column <code class="docutils literal notranslate"><span class="pre">P86</span> <span class="pre">(composer)</span></code> contains both the ID of the
<a class="reference external" href="https://www.wikidata.org/wiki/Property:P86">property ‘composer’</a> and in parenthesis the English label of the
property. The values of the column are the “Q-numbers” of the composer item. For more information, refer to
<a class="reference internal" href="#reconciling"><span class="std std-ref">Reconciling metadata with Wikidata</span></a> below.</p>
</dd>
</dl>
</section>
<section id="contributors-and-annotations">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Contributors and annotations</a><a class="headerlink" href="#contributors-and-annotations" title="Permalink to this heading">¶</a></h3>
<p>Custom fields to give credit to contributors and to keep track of versions of annotation standards and the likes.
The preferred identifiers for persons are ORCIDs such as <code class="docutils literal notranslate"><span class="pre">0000-0002-1986-9545</span></code> or given as URL, such as
<a class="reference external" href="https://orcid.org/0000-0002-1986-9545">https://orcid.org/0000-0002-1986-9545</a>.</p>
<dl class="simple">
<dt>typesetter</dt><dd><p>Name/identifier/homepage of the person(s) or company who engraved the digital edition or major parts of it.</p>
</dd>
<dt>score_integrity</dt><dd><p>Name/identifier/homepage of the person(s) or company who reviewed and corrected the score to make it
match the reference edition/manuscript (potentially referenced under <code class="docutils literal notranslate"><span class="pre">pdf</span></code>).</p>
</dd>
<dt>annotators</dt><dd><p>Name/identifier of each person who contributed new labels. If the file contains several types/versions/iterations,
specify in parenthesis who did what.</p>
</dd>
<dt>reviewers</dt><dd><p>Name/identifier of each person who reviewed annotation labels, potentially modifying them.
If a review pertained only to a particular type/version/iteration, specify in parenthesis which one.</p>
</dd>
<dt>harmony_version</dt><dd><p>Version of the DCML harmony annotation standard used, e.g. <code class="docutils literal notranslate"><span class="pre">2.3.0</span></code>.</p>
</dd>
</dl>
</section>
<section id="reconciling-metadata-with-wikidata">
<span id="reconciling"></span><h3><a class="toc-backref" href="#id31" role="doc-backlink">Reconciling metadata with Wikidata</a><a class="headerlink" href="#reconciling-metadata-with-wikidata" title="Permalink to this heading">¶</a></h3>
<p>Wikidata is a knowledge graph in which</p>
<ul class="simple">
<li><p>each node (a noun considered as subject or object of a relation) is identified by a “Q-number” such as <code class="docutils literal notranslate"><span class="pre">Q636399</span></code>
(<a class="reference external" href="https://www.wikidata.org/wiki/Q636399">the song “Smoke on the Water”</a>),</p></li>
<li><p>each edge (a verb or property) by a “P-number” such as <code class="docutils literal notranslate"><span class="pre">P921</span></code>
(<a class="reference external" href="https://www.wikidata.org/wiki/Property:P921">the property “main subject”</a>, in this example pointing to the node
<a class="reference external" href="https://www.wikidata.org/wiki/Q81085137">Q81085137</a>).</p></li>
</ul>
<p>Reconciling metadata with Wikidata means linking values to nodes in the graph by assigning the relevant Q-numbers,
which can be comfortably achieved with the software <code class="docutils literal notranslate"><span class="pre">OpenRefine</span> <span class="pre">&lt;https://openrefine.org/&gt;</span></code>. As an example,
we take the insufficiently populated <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> from the Annotated Beethoven Corpus version 2.1
(<a class="reference external" href="https://raw.githubusercontent.com/DCMLab/ABC/v2.1/metadata.tsv">link</a>).
The goal of this step-by-step guide is to reconcile the composer and his 16 string quartets with Wikidata.</p>
<section id="creating-a-new-openrefine-project">
<h4><a class="toc-backref" href="#id32" role="doc-backlink">Creating a new OpenRefine project</a><a class="headerlink" href="#creating-a-new-openrefine-project" title="Permalink to this heading">¶</a></h4>
<p>As a first step, we need to make sure
that our metadata table contains values that OpenRefine can reconcile with Wikidata’s node labels. Here, we can
use the file names and some regular expression magic to fill the columns:</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/abc_metadata.png"><img alt="ABC metadata.tsv with populated columns." src="../_images/abc_metadata.png" style="width: 825.6px; height: 387.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-text">ABC metadata.tsv with populated <code class="docutils literal notranslate"><span class="pre">composer</span></code>, <code class="docutils literal notranslate"><span class="pre">workTitle</span></code>, <code class="docutils literal notranslate"><span class="pre">movementNumber</span></code>, and <code class="docutils literal notranslate"><span class="pre">workNumber</span></code> columns.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Next, we load the file into OpenRefine, click on <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">»</span></code>, check the preview, adapt the setting for loading the
TSV file if needed (usually it isn’t), name the project and click on <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">project</span> <span class="pre">»</span></code>.</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../_images/openrefine_project.png"><img alt="Creating a project by loading the metadata.tsv file into OpenRefine." src="../_images/openrefine_project.png" style="width: 484.0px; height: 274.40000000000003px;" /></a>
<figcaption>
<p><span class="caption-text">Creating a project by loading the <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> file into OpenRefine.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="reconciling-a-column">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">Reconciling a column</a><a class="headerlink" href="#reconciling-a-column" title="Permalink to this heading">¶</a></h4>
<p>Now we can start reconciling the values of a column by opening it’s menu <code class="docutils literal notranslate"><span class="pre">Reconcile</span> <span class="pre">-&gt;</span> <span class="pre">Start</span> <span class="pre">reconciling...</span></code>.</p>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="../_images/openrefine_start.png"><img alt="Opening the reconciliation pane in OpenRefine." src="../_images/openrefine_start.png" style="width: 372.8px; height: 372.0px;" /></a>
<figcaption>
<p><span class="caption-text">Opening the reconciliation pane in OpenRefine.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The upcoming pane has a list of services on the left side that should include at least <code class="docutils literal notranslate"><span class="pre">Wikidata</span> <span class="pre">(en)</span></code>, which is
what we click on. OpenRefine tries to guess the item type that the values could be matched with and correctly suggests
<code class="docutils literal notranslate"><span class="pre">Q5</span> <span class="pre">(human)</span></code>. Since the correct type Q5 is already selected we can go ahead with <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">reconciling...</span></code>. Once
the process is complete, a new facet appears on the left side that lets us view the different types of match results.
In this example, all 70 movements have type <code class="docutils literal notranslate"><span class="pre">none</span></code> and we need to pick the correct item that corresponds to the
composer in question.</p>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="../_images/openrefine_match.png"><img alt="Selecting the corresponding Wikidata item." src="../_images/openrefine_match.png" style="width: 779.8px; height: 236.6px;" /></a>
<figcaption>
<p><span class="caption-text">Selecting the corresponding Wikidata item to automatically assign it to all cells.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Sometimes, OpenRefine does not suggest any item. In this case, supposing an item does indeed exist, we can go to
the column’s menu <code class="docutils literal notranslate"><span class="pre">Reconcile</span> <span class="pre">-&gt;</span> <span class="pre">Actions</span> <span class="pre">-&gt;</span> <span class="pre">Match</span> <span class="pre">all</span> <span class="pre">filtered</span> <span class="pre">cells</span> <span class="pre">to...</span></code> and manually search for the item.</p>
<p>Once everything has been correctly matched, we can automatically create a new column to store the Q-numbers.
This is as easy as accessing the column menu <code class="docutils literal notranslate"><span class="pre">Reconcile</span> <span class="pre">-&gt;</span> <span class="pre">Add</span> <span class="pre">entity</span> <span class="pre">identifiers</span> <span class="pre">column...</span></code>. When asked for the
new column name, we use the
<a class="reference external" href="https://www.wikidata.org/wiki/Help:QuickStatements#CSV_file_syntax">QuickStatements CSV logic</a> which boils down to
thinking of each row as the subject of a <code class="docutils literal notranslate"><span class="pre">(subject,</span> <span class="pre">verb,</span> <span class="pre">object)</span></code> triple, and storing <code class="docutils literal notranslate"><span class="pre">object</span></code> Q-numbers in
<code class="docutils literal notranslate"><span class="pre">verb</span></code> columns. In this example, we are storing Q-numbers that correspond to the pieces’
<a class="reference external" href="https://www.wikidata.org/wiki/Property:P86">‘composer’ property</a> and therefore we name the new column
<code class="docutils literal notranslate"><span class="pre">P86</span> <span class="pre">(composer)</span></code>:</p>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="../_images/openrefine_composer_ids.png"><img alt="Metadata table with the newly created column &quot;P86 (composer)&quot; pointing to the matched Q-number(s)." src="../_images/openrefine_composer_ids.png" style="width: 198.79999999999998px; height: 265.3px;" /></a>
<figcaption>
<p><span class="caption-text">Metadata table with the newly created column <code class="docutils literal notranslate"><span class="pre">P86</span> <span class="pre">(composer)</span></code> pointing to the matched Q-number(s).</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The result can now easily written back to the original file using the menu <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">-&gt;</span> <span class="pre">Tab-separated</span> <span class="pre">value</span></code> in order
to then insert the new values into the MuseScore files. Please make sure to check the diff of the updated
<code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> before committing to prevent committing unwanted changes or, even worse, having them written
into the scores.</p>
</section>
<section id="reconciling-the-worktitle-column">
<h4><a class="toc-backref" href="#id34" role="doc-backlink">Reconciling the <code class="docutils literal notranslate"><span class="pre">workTitle</span></code> column</a><a class="headerlink" href="#reconciling-the-worktitle-column" title="Permalink to this heading">¶</a></h4>
<p>Many Wikidata items can be expected to bear labels such as <code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">Quartet</span> <span class="pre">No.</span> <span class="pre">1</span></code> and therefore there is quite some
ambiguity involved in matching. Since we have already reconciled the <code class="docutils literal notranslate"><span class="pre">composer</span></code> column, we can use it to constrain
the reconciliation of the <code class="docutils literal notranslate"><span class="pre">workTitle</span></code> column to pieces that have been composed by Beethoven.</p>
<p>To achieve that, we bring up the reconciliation pane and, once more, OpenRefine correctly infers the type of the
items that we are trying to match, <code class="docutils literal notranslate"><span class="pre">Q105543609</span> <span class="pre">(musical</span> <span class="pre">work/composition)</span></code>. On the right side, we assign the
property <code class="docutils literal notranslate"><span class="pre">P86</span> <span class="pre">(composer)</span></code> to the <code class="docutils literal notranslate"><span class="pre">composer</span></code> column by typing <code class="docutils literal notranslate"><span class="pre">composer</span></code> and selecting the correct property.</p>
<figure class="align-default" id="id7">
<a class="reference internal image-reference" href="../_images/openrefine_constrain.png"><img alt="Matching the workTitle column constraint by the reconciled composer column." src="../_images/openrefine_constrain.png" style="width: 629.3px; height: 410.2px;" /></a>
<figcaption>
<p><span class="caption-text">Matching the workTitle column constraint by the reconciled composer column.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>In this case, we can try to additionally use the <code class="docutils literal notranslate"><span class="pre">workNumber</span></code> column. This makes sense without prior reconciliation
because the corresponding property <code class="docutils literal notranslate"><span class="pre">P10855</span> <span class="pre">(opus</span> <span class="pre">number)</span></code> has a literal data type, string. In other words,
Wikidata users populate this property with free text rather than with a Q-number. We cannot be sure that the property
is present at all and, if it is, whether the strings follow a consistent format. Another source of inconsistency
could be a confusion with <code class="docutils literal notranslate"><span class="pre">P528</span> <span class="pre">(catalog</span> <span class="pre">code)</span></code>,
<a class="reference external" href="https://www.wikidata.org/wiki/Wikidata:Property_proposal/opus_number#%7B%7Bint%3ATalk%7D%7D">as discussed here</a>.
In an ideal world we would not only consume metadata from the knowledge graph but also help cleaning it up for our
domain…..</p>
<figure class="align-default" id="id8">
<a class="reference internal image-reference" href="../_images/openrefine_work_ids.png"><img alt="Matching Beethoven string quartets with the correct Wikidata items." src="../_images/openrefine_work_ids.png" style="width: 590.8px; height: 301.0px;" /></a>
<figcaption>
<p><span class="caption-text">Matching Beethoven string quartets with the correct Wikidata items.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The screenshot shows that 53 were matched automatically and 17 are ambiguous. In theory we could automatically
match them based on their match score but, as we can see, this would wrongly match our <code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">Quartet</span> <span class="pre">No.</span> <span class="pre">15</span></code>
with the item <code class="docutils literal notranslate"><span class="pre">Q270886</span> <span class="pre">(String</span> <span class="pre">Quartet</span> <span class="pre">No.</span> <span class="pre">8)</span></code>, meaning we need to go through the works and select the right match
carefully. However, once we have matched No. 15 with the correct item and see that for the other ambiguous pieces
the correct items have the highest match score respectively, we can use the
<code class="docutils literal notranslate"><span class="pre">Reconcile</span> <span class="pre">-&gt;</span> <span class="pre">Actions</span> <span class="pre">-&gt;</span> <span class="pre">Match</span> <span class="pre">each</span> <span class="pre">cell</span> <span class="pre">to</span> <span class="pre">its</span> <span class="pre">best</span> <span class="pre">candidate</span></code> shortcut to finalize the task.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the name of thoroughness, we also need to take a look at the automatically matched items to avoid
false positives.</p>
</div>
</section>
<section id="pulling-additional-information">
<h4><a class="toc-backref" href="#id35" role="doc-backlink">Pulling additional information</a><a class="headerlink" href="#pulling-additional-information" title="Permalink to this heading">¶</a></h4>
<p>Obviously, with all cells having the same composer value we would have been faster to create the <code class="docutils literal notranslate"><span class="pre">P86</span> <span class="pre">(composer)</span></code>
column manually, filling in the value <code class="docutils literal notranslate"><span class="pre">Q255</span></code> for all cells. But using
OpenRefine gives us the advantage that, once reconciled, we can pull additional information on the composer item
from the Wikidata knowledge graph. For that we simply access the matched composer column’s menu
<code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">column</span> <span class="pre">-&gt;</span> <span class="pre">Add</span> <span class="pre">columns</span> <span class="pre">from</span> <span class="pre">reconciled</span> <span class="pre">values</span></code> which will lead us to a list of properties that we can simply
click on to create additional columns. For example, we can easily add columns called
“country of citizenship”, “native language”, “place of birth”, “place of death” and “religion or worldview”.</p>
<p>This step can be repeated for the added columns. The screenshot shows the column <code class="docutils literal notranslate"><span class="pre">country</span></code> that was created by
pulling the property <code class="docutils literal notranslate"><span class="pre">P17</span> <span class="pre">(country)</span></code> for the <code class="docutils literal notranslate"><span class="pre">Electorate</span> <span class="pre">of</span> <span class="pre">Cologne</span></code> items. In addition the columns
<code class="docutils literal notranslate"><span class="pre">MusicBrainz</span> <span class="pre">work</span> <span class="pre">ID</span></code>, <code class="docutils literal notranslate"><span class="pre">publication</span> <span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">tonality</span></code>, and <code class="docutils literal notranslate"><span class="pre">IMSLP</span> <span class="pre">ID</span></code> have been created from the
reconciled work IDs.</p>
<figure class="align-default" id="id9">
<a class="reference internal image-reference" href="../_images/openrefine_result.png"><img alt="Additional columns pulled from the Wikidata knowledge graph based on the reconciled composer items." src="../_images/openrefine_result.png" style="width: 1204.0px; height: 784.6999999999999px;" /></a>
<figcaption>
<p><span class="caption-text">Additional columns pulled from the Wikidata knowledge graph based on the reconciled composer items;
displayed for the 16 first movements.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>After exporting the newly gained values to our original <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code>, we can process them further, for example,</p>
<ul class="simple">
<li><p>by turning the publication dates that come in ISO format into our default
<a class="reference internal" href="#composition-year-columns"><span class="std std-ref">composition year columns</span></a> which contain only a year number;</p></li>
<li><p>by integrating the values in the <code class="docutils literal notranslate"><span class="pre">tonality</span></code> column into the <code class="docutils literal notranslate"><span class="pre">workTitle</span></code> column (to get something along the lines
of <code class="docutils literal notranslate"><span class="pre">String</span> <span class="pre">Quartet</span> <span class="pre">No.</span> <span class="pre">1</span> <span class="pre">in</span> <span class="pre">F</span> <span class="pre">major</span></code>, for example);</p></li>
<li><p>by renaming the column <code class="docutils literal notranslate"><span class="pre">IMSLP</span> <span class="pre">ID</span></code> to its default name <code class="docutils literal notranslate"><span class="pre">imslp</span></code>;</p></li>
<li><p>by using the column <code class="docutils literal notranslate"><span class="pre">MusicBrainz</span> <span class="pre">work</span> <span class="pre">ID</span></code> for automatically retrieving IDs for the individual movements for our
default column <code class="docutils literal notranslate"><span class="pre">musicbrainz</span></code>; as well as values for the column <code class="docutils literal notranslate"><span class="pre">movementTitle</span></code>, for example.</p></li>
</ul>
</section>
<section id="future-work-sub-work-level-items">
<h4><a class="toc-backref" href="#id36" role="doc-backlink">Future work: Sub-work-level items</a><a class="headerlink" href="#future-work-sub-work-level-items" title="Permalink to this heading">¶</a></h4>
<p>Wikidata has a simple mechanism for linking a work to its parts, such as movements. Consider for example the item
for Joseph Haydn’s Trumpet Concerto in E-flat major, Hob. VIIe:1, <a class="reference external" href="https://www.wikidata.org/wiki/Q1585960">Q1585960</a>.
The property <code class="docutils literal notranslate"><span class="pre">P527</span> <span class="pre">(has</span> <span class="pre">part(s))</span></code> links it to the three items that represent its three movements, each of which is
linked to its parent item via <code class="docutils literal notranslate"><span class="pre">P361</span> <span class="pre">(part</span> <span class="pre">of)</span></code>. The problem is that in the majority of cases, such sub-work-level
items do not exist yet. MusicBrainz work IDs, on the other hand, are often available (because they are required
to identify CD tracks). Once we have reconciled our scores representing individual movements with Wikidata work IDs,
it would be actually a small step to go ahead and create items for the movements automatically via OpenRefine.
We should consider doing this at least for the cases where sub-work-level IDs are already available on
MusicBrainz. We could also consider to link the items to our scores in one go.</p>
</section>
</section>
</section>
<section id="finalizing-a-repository-for-publication">
<h2><a class="toc-backref" href="#id37" role="doc-backlink">Finalizing a repository for publication</a><a class="headerlink" href="#finalizing-a-repository-for-publication" title="Permalink to this heading">¶</a></h2>
<p>This section describes some of the steps that might be necessary to clean up a repository and make it presentable to
the public. Rather than a fixed sequence of steps, this process is driven by the expected shape and completeness
allowing the repo to qualify as uniform with other published DCML corpora. It requires knowledge of the commandline,
very good familiarity with git, and experience with using <code class="docutils literal notranslate"><span class="pre">ms3</span></code> commands.</p>
<p>This section is from July 2023 and coined to the particular case where a long range of repos need to be (carfully)
updated with new filenames &amp; additional JSON metadata files generated by the bleeding-edge <code class="docutils literal notranslate"><span class="pre">ms3</span></code> version 2. It
requires being able to use both the old <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">1.2.12</span></code> and the latest version in alternation, e.g. using virtual
environments or <code class="docutils literal notranslate"><span class="pre">pipx</span></code> (see below). To date, it also requires access to DCML’s private repos.</p>
<p>In a nutshell:</p>
<ol class="arabic simple">
<li><p>All currently ongoing work needs to be <a class="reference internal" href="#ongoing-work"><span class="std std-ref">finalized</span></a> first before the repo itself can be finalized.</p></li>
<li><p>(Work package type <code class="docutils literal notranslate"><span class="pre">Harmonize</span> <span class="pre">repo</span> <span class="pre">structure</span> <span class="pre">&amp;</span> <span class="pre">versions</span></code>) The repository <a class="reference internal" href="#repo-structure"><span class="std std-ref">structure</span></a> needs to be checked and updated if necessary.</p></li>
</ol>
<p>As a running example, let’s consider this
<a class="reference external" href="https://github.com/DCMLab/peri_euridice/tree/2129571849c267bee97d293b8fcc9fc3a27603b8">pre-clean commit of peri_euridice</a>.</p>
<section id="finalize-ongoing-work">
<span id="ongoing-work"></span><h3><a class="toc-backref" href="#id38" role="doc-backlink">Finalize ongoing work</a><a class="headerlink" href="#finalize-ongoing-work" title="Permalink to this heading">¶</a></h3>
<section id="check-openproject">
<h4><a class="toc-backref" href="#id39" role="doc-backlink">0. Check OpenProject</a><a class="headerlink" href="#check-openproject" title="Permalink to this heading">¶</a></h4>
<p>If there are work packages for this repo, we should make sure that all of them have been marked as “Done”.</p>
<figure class="align-default" id="id10">
<a class="reference internal image-reference" href="../_images/peri_workpackages_done.png"><img alt="Screenshot from OpenProject showing that all work packages for the repo have been marked as &quot;Done&quot;." src="../_images/peri_workpackages_done.png" style="width: 398.29999999999995px; height: 221.2px;" /></a>
<figcaption>
<p><span class="caption-text">Screenshot from OpenProject showing that all work packages for the repo have been marked as “Done”.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="addressing-open-pull-requests">
<h4><a class="toc-backref" href="#id40" role="doc-backlink">1. Addressing open Pull Requests</a><a class="headerlink" href="#addressing-open-pull-requests" title="Permalink to this heading">¶</a></h4>
<p>If there are open PRs, we need to check their nature and ping  the people involved, asking them for progress.</p>
</section>
<section id="check-for-unmerged-branches">
<h4><a class="toc-backref" href="#id41" role="doc-backlink">2. Check for unmerged branches</a><a class="headerlink" href="#check-for-unmerged-branches" title="Permalink to this heading">¶</a></h4>
<p>By first clicking on <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">branches</span></code> and then on <code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">branches</span></code>, you see the current state of affairs:</p>
<figure class="align-default" id="id11">
<a class="reference internal image-reference" href="../_images/peri_old_branches.png"><img alt="Screenshot from GitHub showing that there are few stale branches and some that have not been merged." src="../_images/peri_old_branches.png" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-text">Screenshot from GitHub showing that there are few stale branches and some that have not been merged, including
one open PR.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The little bar charts show, towards the left, by how many commits a branch is behind <code class="docutils literal notranslate"><span class="pre">main</span></code> and, towards the right,
by how many commits it is ahead of <code class="docutils literal notranslate"><span class="pre">main</span></code>. If the latter is larger than zero, this branch contains work in progress
that has not been merged yet!</p>
<p>Here is how the branches are to be cleaned up:</p>
<ul class="simple">
<li><p>The branch <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> needs to be ignored entirely and left as it is!</p></li>
<li><p>All branches that are not ahead of <code class="docutils literal notranslate"><span class="pre">main</span></code> should be deleted at this point. This is the case for the six branches
showing that their PR has been merged, their bar charts show zero on the right side.</p></li>
<li><p>If there is still a branch with a PR “Open”, as in the example, that means we haven’t done step 1 yet, i.e., we need
to get all PRs finalized (after merging, the branch can be deleted).</p></li>
<li><p>If there are other branches with work in progress (in the screenshot, <code class="docutils literal notranslate"><span class="pre">scene_0_workflow_update</span></code>), we need to be
extra careful to take the right decision and to check with the author(s).
Several scenarios are possible:</p>
<ul>
<li><p>They are still working on it and we should wait for their work to be reviewed in a PR and then merged.</p></li>
<li><p>The commits are irrelevant and the branch can be deleted.</p></li>
<li><p>The commits have been rebased onto another branch and merged into <code class="docutils literal notranslate"><span class="pre">main</span></code> from there. Rebased commits have
other hashes than their originals so GitHub would not recognize if this the case. That’s why it is important to
remove an original branch if it has been rebased and merged.</p></li>
</ul>
</li>
</ul>
<p>This step is completed once we are left with the branches <code class="docutils literal notranslate"><span class="pre">main</span></code> and <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> only.</p>
</section>
</section>
<section id="update-repository-structure">
<span id="repo-structure"></span><h3><a class="toc-backref" href="#id42" role="doc-backlink">Update repository structure</a><a class="headerlink" href="#update-repository-structure" title="Permalink to this heading">¶</a></h3>
<p>All steps in this section are to be performed locally and, once completed, to be merged through a reviewed PR. This
section requires using two different versions of <code class="docutils literal notranslate"><span class="pre">ms3</span></code>, namely the latest 1.x version, <code class="docutils literal notranslate"><span class="pre">ms3&lt;2.0.0</span></code>, and the latest
2.x version, <code class="docutils literal notranslate"><span class="pre">ms3&gt;=2</span></code>. This can be achieved by using virtual environments. One very practical solution to this,
which we use in this documentation, is through the <code class="docutils literal notranslate"><span class="pre">pipx</span></code> package. It lets us install the two different versions and
add a suffix to each so we have both versions available without having to switch environments.
After <a class="reference external" href="https://pypa.github.io/pipx/installation/">installing pipx</a>, we use the following setup:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipx<span class="w"> </span>install<span class="w"> </span>--suffix<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;ms3&lt;2.0.0&quot;</span>
pipx<span class="w"> </span>install<span class="w"> </span>--suffix<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="s2">&quot;ms3&gt;=2.0.0&quot;</span>
</pre></div>
</div>
<p>This lets us use the old version as <code class="docutils literal notranslate"><span class="pre">ms31</span></code> and the new one as <code class="docutils literal notranslate"><span class="pre">ms32</span></code>. We can check our setup via</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pipx<span class="w"> </span>list
<span class="c1"># Output (latest versions as per the 17th of July 2023):</span>
<span class="c1"># package ms3 1.2.12 (ms31), installed using Python 3.10.11</span>
<span class="c1">#  - ms31</span>
<span class="c1"># package ms3 2.0.0 (ms32), installed using Python 3.10.11</span>
<span class="c1">#  - ms32</span>
</pre></div>
</div>
<p>And we can test the commands like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ms31<span class="w"> </span>--version
<span class="c1"># Output: 1.2.12</span>
ms32<span class="w"> </span>--version
<span class="c1"># Output: 2.0.0</span>
</pre></div>
</div>
<section id="create-a-version-tag">
<h4><a class="toc-backref" href="#id43" role="doc-backlink">3. Create a version tag</a><a class="headerlink" href="#create-a-version-tag" title="Permalink to this heading">¶</a></h4>
<p>Now that there is no work in progress is the perfect time for creating a version tag in order to describe the current
status of the repository for future reference. The documentation assumes that you have checked out and pulled <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p>
<p>The syntax is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>&lt;version&gt;<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;&lt;description&gt;&quot;</span>
</pre></div>
</div>
<p>Every version number has the form <code class="docutils literal notranslate"><span class="pre">v&lt;ms3&gt;.&lt;counter&gt;</span></code>, which means it</p>
<ul class="simple">
<li><p>starts with a “v” (for “version”)</p></li>
<li><p>is followed by the major version of ms3 used to extract the data (i.e., “0” for ms3&lt;1.0.0, “1” for versions 1.0.0 -
1.2.12, and “2” for versions &gt;= 2.0.0)</p></li>
<li><p>followed by a dot</p></li>
<li><p>and a monotonic counter starting from 0 that is incremented by one for every new version.</p></li>
</ul>
<p>In the default case, right now, the current version has been extracted through the workflow with <code class="docutils literal notranslate"><span class="pre">ms3</span></code> version 1.
If you want to be sure you can either</p>
<ul class="simple">
<li><p>check the column <code class="docutils literal notranslate"><span class="pre">ms3_version</span></code> in <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code>, or</p></li>
<li><p>the file extensions of the TSV files: Starting with version 2, they include the facet name such that, for example,
all files in the folder <code class="docutils literal notranslate"><span class="pre">notes</span></code> end with <code class="docutils literal notranslate"><span class="pre">.notes.tsv</span></code>. If this is not the case, as is expected, the new
version should start with “1”.</p></li>
</ul>
<p>In order to find out the next version number, we need to look at the existing tags. We can see the full list with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span>-n
</pre></div>
</div>
<p>And we can see the latest version with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>describe<span class="w"> </span>--tags<span class="w"> </span>--abbrev<span class="o">=</span><span class="m">0</span>
</pre></div>
</div>
<p>which will output “fatal: No names found, cannot describe anything.” if there are no tags yet. Depending on the output
we assign:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v1.0</span></code> if there are no tags yet or only tags starting with “v0”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v1.1</span></code> if the latest tag is <code class="docutils literal notranslate"><span class="pre">v1.0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v1.10</span></code> if the latest tag is <code class="docutils literal notranslate"><span class="pre">v1.9</span></code></p></li>
<li><p>etc.</p></li>
</ul>
<p>We assign the tag to the current commit together with a message (just like in a commit), for example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>v1.0<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Fully annotated corpus before finalizing it for publication.&quot;</span>
git<span class="w"> </span>push<span class="w"> </span>--tags
</pre></div>
</div>
<p>The second command pushes the tag to GitHub.</p>
<p>Please note that this specification has been newly added (July 2023) and you may encounter a repository that has
already a version above “v1”: In such a case, please discuss with DCML members how to proceed.</p>
</section>
<section id="remove-the-automated-github-workflow-and-all-deprecated-files">
<h4><a class="toc-backref" href="#id44" role="doc-backlink">4. Remove the automated GitHub workflow and all deprecated files</a><a class="headerlink" href="#remove-the-automated-github-workflow-and-all-deprecated-files" title="Permalink to this heading">¶</a></h4>
<p>Now that we have pinned the version, we can start streamlining the repository structure on a new branch, e.g.
“repo_structure”, and then create a pull request. During finalization we are performing the workflow tasks manually
using the <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">review</span></code> command. So we want to first
<strong>deactivate the GitHub action</strong> by simply removing the folder <code class="docutils literal notranslate"><span class="pre">.github</span></code> (using the command <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span> <span class="pre">-r</span> <span class="pre">.github</span></code>)
and committing the change.</p>
<p>Then we streamline the repository to harmonize it with the other ones.
By default, every repo should come with the files</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">README.md</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code></p></li>
</ul>
<p>and with the folders</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MS3</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">harmonies</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">measures</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdf</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reviewed</span></code></p></li>
</ul>
<p>each containing one file per row in <code class="docutils literal notranslate"><span class="pre">metadata.tsv</span></code> (with the exception of <code class="docutils literal notranslate"><span class="pre">pdf</span></code> which often includes fewer files).
Some repos might also include some of the following files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.gitignore</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IGNORED_WARNINGS</span></code></p></li>
</ul>
<p>They should be left untouched.</p>
<p>Things to be removed, if present (one commit for each list item):</p>
<ul class="simple">
<li><p>the folder <code class="docutils literal notranslate"><span class="pre">tonicizations</span></code></p></li>
<li><p>top-level files ending on <code class="docutils literal notranslate"><span class="pre">.log</span></code></p></li>
<li><p>in the <code class="docutils literal notranslate"><span class="pre">MS3</span></code> folder: Files ending on <code class="docutils literal notranslate"><span class="pre">_reviewed.mscx</span></code> (in the Peri case here there were two of them).</p></li>
</ul>
<p>Once again, you can use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span> <span class="pre">&lt;file&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span> <span class="pre">-r</span> <span class="pre">&lt;folder&gt;</span></code> and commit each deletion separately.</p>
<p>For all other things, please ask on Mattermost before deleting.</p>
<p>The command sequence used in the present Peri example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rm<span class="w"> </span>MS3/*_reviewed.mscx
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;removes superfluous _reviewed files&quot;</span>
git<span class="w"> </span>rm<span class="w"> </span>-r<span class="w"> </span>.github
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;removes annotation workflow&quot;</span>
git<span class="w"> </span>rm<span class="w"> </span>warnings.log
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;removes warnings.log&quot;</span>
git<span class="w"> </span>rm<span class="w"> </span>-r<span class="w"> </span>tonicizations
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;removes tonicizations&quot;</span>
</pre></div>
</div>
</section>
<section id="update-the-extracted-files-to-ms3-version-2">
<h4><a class="toc-backref" href="#id45" role="doc-backlink">5. Update the extracted files to ms3 version 2</a><a class="headerlink" href="#update-the-extracted-files-to-ms3-version-2" title="Permalink to this heading">¶</a></h4>
<p>Assuming that the current data has been extracted with <code class="docutils literal notranslate"><span class="pre">ms3</span></code> version 1.x, before we update the data, we first extract
one last time with the old version (hence the setup at the beginning of the section). We do this by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ms31<span class="w"> </span>extract<span class="w"> </span>-M<span class="w"> </span>-N<span class="w"> </span>-X<span class="w"> </span>-D
</pre></div>
</div>
<p>(for measure, notes, expanded, metadata) and commit the results with the message <code class="docutils literal notranslate"><span class="pre">&quot;ms3</span> <span class="pre">extract</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span> <span class="pre">(v1.2.12)&quot;</span></code>
(assuming that the latest v1 is <code class="docutils literal notranslate"><span class="pre">v1.2.12</span></code>).</p>
<p>Then we update the data to v2 in four steps:</p>
<ul class="simple">
<li><p>First, we delete the folders <code class="docutils literal notranslate"><span class="pre">measures</span></code>, <code class="docutils literal notranslate"><span class="pre">notes</span></code>, and <code class="docutils literal notranslate"><span class="pre">harmonies</span></code> without committing the change (e.g., in your
file browser).</p></li>
<li><p>Then we run <code class="docutils literal notranslate"><span class="pre">ms32</span> <span class="pre">extract</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span></code>;</p></li>
<li><p>commit everything with the message <code class="docutils literal notranslate"><span class="pre">&quot;ms3</span> <span class="pre">extract</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span> <span class="pre">(v2.0.0)&quot;</span></code> (or whatever the latest version is);</p></li>
</ul>
<p>The branch is now ready to be reviewed and then merged through a Pull Request:</p>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="../_images/peri_harmonization_pr.png"><img alt="Screenshot showing a Pull Request harmonizing the repository by deleting and updating files." src="../_images/peri_harmonization_pr.png" style="width: 709.6px; height: 555.2px;" /></a>
<figcaption>
<p><span class="caption-text">Screenshot showing a Pull Request harmonizing the repository by deleting and updating files. Note that the
description links the PR to the work package on OpenProject and that the label corresponds to the work package type.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Once the PR has been created, you can update the work package status to “Needs review”.
Only when the PR has been reviewed and merged can we proceed with either metadata cleaning or eliminating warnings.
Once merged, we can assign assign a new tag,
e.g. <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">-a</span> <span class="pre">v2.0</span> <span class="pre">-m</span> <span class="pre">&quot;Extracted</span> <span class="pre">facets</span> <span class="pre">using</span> <span class="pre">ms3</span> <span class="pre">version</span> <span class="pre">2.0.0&quot;</span></code> (see step 3).</p>
</section>
</section>
<section id="eliminating-all-warnings">
<span id="eliminating-warnings"></span><h3><a class="toc-backref" href="#id46" role="doc-backlink">Eliminating all warnings</a><a class="headerlink" href="#eliminating-all-warnings" title="Permalink to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section is a draft.</p>
</div>
<p>Once the repository has been updated with <code class="docutils literal notranslate"><span class="pre">ms3</span></code> version 2, only this version should be used for the remaining tasks.
The first step is to create a new branch for the task, e.g. “warnings” and to update the current state of warnings by
using</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">review</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span></code> (or, if you continue with the setup above, <code class="docutils literal notranslate"><span class="pre">ms32</span> <span class="pre">review</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span></code>) and</p></li>
<li><p>committing the changes with the message <code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">review</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span> <span class="pre">(v2.0.0)</span></code> (or whatever the latest version is).</p></li>
</ul>
<p>If there is nothing to be committed, we’re already done. Otherwise, we need to fix the warnings one after the other.
Every time we (think we) have addressed a warning (or group of warnings), we execute the review command again to see if
it has indeed disappeared. Since most warnings concern one particular file, we can use the command with the argument
<code class="docutils literal notranslate"><span class="pre">-i</span></code> (long form <code class="docutils literal notranslate"><span class="pre">--include</span></code>), followed by a regular expression matching only the file(s) we want to check. For
example, if the filename convention is something like <code class="docutils literal notranslate"><span class="pre">op&lt;##&gt;n&lt;##&gt;_&lt;movement&gt;.mscx</span></code>, we could execute
<code class="docutils literal notranslate"><span class="pre">ms3</span> <span class="pre">review</span> <span class="pre">-M</span> <span class="pre">-N</span> <span class="pre">-X</span> <span class="pre">-D</span> <span class="pre">-i</span> <span class="pre">op02</span></code> to review all file containing “op02” in their names, or “02n02” for op.2, no.2 only,
etc. Once successfully addressed (or explicitly ignored), we commit the change with an informative commit
message (just like during a review) explaining the change.</p>
<p>Please keep in mind that the validator is simply a tool for detecting potential problems. If you have checked a
particular place and found that the warning is not justified, please add it to the <code class="docutils literal notranslate"><span class="pre">IGNORED_WARNINGS</span></code> file, followed
by a concise comment, which <em>can</em> replace the indented warning text following the header that includes the logger name,
but <em>must</em> begin each new line with a TAB. The comment should clarify for future readers why the warning is
ill-founded. If you are not sure, please ask on Mattermost. Over the course of time and based on these questions, we
will complete this section with concrete instructions on how individual warnings should/can be addressed (and/or
fix the validator).</p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, École Polytechnique Fédérale de Lausanne.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>